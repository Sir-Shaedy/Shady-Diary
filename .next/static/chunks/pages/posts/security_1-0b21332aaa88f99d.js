(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[558],{290:(e,o,t)=>{"use strict";t.r(o),t.d(o,{default:()=>i});var r=t(7876),n=t(4232);function i(){let[e,o]=(0,n.useState)(!0),t={backgroundColor:e?"#0a0a0a":"#ffffff",textColor:e?"#ffffff":"#0000ffff",accentColor:e?"#e7e2e2ff":"#000000ff",borderColor:e?"#2a2a2a":"#e5e5e5",linkColor:e?"#60a5fa":"#fa1d00ff",cardBg:e?"#141414":"#fafafa",codeBg:e?"#1a1a1a":"#f6f8fa",codeText:e?"#e5e5e5":"#1a1a1a",gradientFrom:e?"#3b82f6":"#2563eb",gradientTo:e?"#8b5cf6":"#7c3aed",categoryBg:e?"#1e3a5f":"#dbeafe",categoryText:e?"#60a5fa":"#1e40af",categoryBorder:e?"#2563eb":"#3b82f6"};return(0,r.jsxs)("div",{style:{minHeight:"100vh",backgroundColor:t.backgroundColor,color:t.textColor,transition:"background-color 0.3s ease, color 0.3s ease"},children:[(0,r.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,height:"250px",background:"linear-gradient(135deg, ".concat(t.gradientFrom,"15 0%, ").concat(t.gradientTo,"15 100%)"),opacity:.5,pointerEvents:"none",zIndex:0,transition:"background 0.3s ease"}}),(0,r.jsxs)("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"0 20px",position:"relative",zIndex:1},children:[(0,r.jsxs)("header",{style:{paddingTop:"30px",marginBottom:"50px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsx)("a",{href:"/",style:{color:t.linkColor,textDecoration:"none",fontSize:"14px",fontWeight:"600",display:"inline-flex",alignItems:"center",gap:"6px",transition:"gap 0.2s ease"},onMouseOver:e=>e.currentTarget.style.gap="10px",onMouseOut:e=>e.currentTarget.style.gap="6px",children:"← Back to all posts"}),(0,r.jsx)("button",{onClick:()=>o(!e),style:{padding:"10px 20px",backgroundColor:t.cardBg,color:t.textColor,border:"2px solid ".concat(t.borderColor),borderRadius:"50px",cursor:"pointer",fontSize:"14px",fontWeight:"600",transition:"all 0.3s ease",boxShadow:e?"0 4px 12px rgba(0,0,0,0.3)":"0 4px 12px rgba(0,0,0,0.08)"},onMouseOver:e=>{e.currentTarget.style.transform="scale(1.05)",e.currentTarget.style.borderColor=t.linkColor},onMouseOut:e=>{e.currentTarget.style.transform="scale(1)",e.currentTarget.style.borderColor=t.borderColor},children:e?"☀️ Light":"\uD83C\uDF19 Dark"})]}),(0,r.jsxs)("div",{style:{marginBottom:"50px"},children:[(0,r.jsxs)("div",{style:{marginBottom:"20px",display:"flex",gap:"12px",alignItems:"center"},children:[(0,r.jsx)("span",{style:{display:"inline-block",padding:"6px 14px",backgroundColor:t.categoryBg,borderRadius:"20px",fontSize:"11px",fontWeight:"700",color:t.categoryText,textTransform:"uppercase",letterSpacing:"0.8px",border:"1px solid ".concat(t.categoryBorder)},children:"Blockchain Security"}),(0,r.jsx)("span",{style:{fontSize:"13px",color:t.accentColor,fontWeight:"500"},children:"12 min read"})]}),(0,r.jsx)("h1",{style:{fontSize:"44px",fontWeight:"800",marginBottom:"16px",lineHeight:"1.2",letterSpacing:"-1px",color:t.textColor},children:"Understanding Pcaversaccio's Whitehat Frontrunning Script"}),(0,r.jsx)("p",{style:{fontSize:"14px",color:t.accentColor,fontWeight:"500"},children:"Published on November 16, 2025"})]}),(0,r.jsxs)("article",{style:{fontSize:"17px",lineHeight:"1.8",color:t.accentColor,paddingBottom:"60px"},children:[(0,r.jsx)("h2",{style:{fontSize:"32px",marginTop:"50px",marginBottom:"20px",fontWeight:"700",color:t.textColor,letterSpacing:"-0.5px"},children:"Introduction: What is Frontrunning?"}),(0,r.jsx)("p",{style:{marginBottom:"20px",fontSize:"22px"},children:"Frontrunning is a common occurrence in blockchain, especially in DeFi trades where opportunistic actors exploit transaction timing to steal value. Put simply, frontrunning is the act of anticipating someone else's transaction and submitting your own first, usually with a higher fee, since validators prioritize transactions that maximize their income."}),(0,r.jsx)("p",{style:{marginBottom:"20px",fontSize:"22px"},children:"While often malicious, frontrunning can also be used defensively. In cases of wallet compromise, the rightful owner can race the hacker by submitting a replacement transaction with the same nonce but a higher fee. Recently, I discovered Pcaversaccio's whitehat frontrunning script, which turns this tactic into a powerful rescue tool. In this article, I'll explore how it works."}),(0,r.jsx)("hr",{style:{border:"none",borderTop:"1px solid ".concat(t.borderColor),margin:"40px 0"}}),(0,r.jsx)("h2",{style:{fontSize:"32px",marginTop:"50px",marginBottom:"20px",fontWeight:"700",color:t.textColor,letterSpacing:"-0.5px"},children:"How Exactly Does Frontrunning Happen?"}),(0,r.jsx)("p",{style:{marginBottom:"20px",fontSize:"22px"},children:"Consider this simple analogy:"}),(0,r.jsx)("p",{style:{marginBottom:"20px",padding:"20px",fontSize:"22px",backgroundColor:t.cardBg,borderLeft:"4px solid ".concat(t.linkColor),borderRadius:"4px"},children:"Imagine Alice, a Justin Bieber fan, wants to buy a concert ticket online. There's only one ticket left. Bob sees Alice's request and quickly submits his own purchase with faster processing. Bob gets the ticket first, leaving Alice out. Unfair, right?"}),(0,r.jsxs)("p",{style:{marginBottom:"20px",fontSize:"22px"},children:["Now replace ",(0,r.jsx)("strong",{style:{color:t.textColor},children:'"ticket"'})," with ",(0,r.jsx)("strong",{style:{color:t.textColor},children:'"transaction"'})," and ",(0,r.jsx)("strong",{style:{color:t.textColor},children:'"processing speed"'})," with ",(0,r.jsx)("strong",{style:{color:t.textColor},children:'"gas fee."'})," This scenario happens a lot in DeFi, where trades affect token prices. For example, Mark submits a large buy order that will raise a token's price. A frontrunner can jump ahead, buy at the lower price, then sell immediately after Mark's transaction executes. This is called a ",(0,r.jsx)("strong",{style:{color:t.textColor},children:"sandwich attack"}),"."]}),(0,r.jsx)("div",{style:{margin:"40px 0",padding:"10px",width:"500px",alignItems:"center",backgroundColor:t.cardBg,borderRadius:"12px",border:"1px solid ".concat(t.borderColor),marginLeft:"70px"},children:(0,r.jsx)("img",{src:"/images/sandwich.png",alt:"Sandwich Attack Diagram",style:{maxWidth:"100%",height:"auto",borderRadius:"10px",boxShadow:e?"0 4px 20px rgba(0,0,0,0.4)":"0 4px 20px rgba(0,0,0,0.1)"}})}),(0,r.jsx)("hr",{style:{border:"none",borderTop:"1px solid ".concat(t.borderColor),margin:"40px 0"}}),(0,r.jsx)("h2",{style:{fontSize:"32px",marginTop:"50px",marginBottom:"20px",fontWeight:"700",color:t.textColor,letterSpacing:"-0.5px"},children:"What the Whitehat Script Does"}),(0,r.jsx)("p",{style:{marginBottom:"20px",fontSize:"22px"},children:"Imagine logging into your wallet and realizing it's been hacked. Normally, you'd try to quickly transfer funds out, but reflexes alone rarely beat automated bots."}),(0,r.jsxs)("p",{style:{marginBottom:"20px",fontSize:"22px"},children:["Instead, Pcaversaccio's script lets you craft a transaction with the ",(0,r.jsx)("strong",{style:{color:t.textColor},children:"same nonce"})," as the hacker's, but with a ",(0,r.jsx)("strong",{style:{color:t.textColor},children:"higher priority fee"}),". Submitted via ",(0,r.jsx)("strong",{style:{color:t.textColor},children:"Flashbots"}),", your transaction stays private (hidden from the public mempool), giving you a higher chance of winning the race. In short: you frontrun the hacker to rescue your own funds."]}),(0,r.jsx)("hr",{style:{border:"none",borderTop:"1px solid ".concat(t.borderColor),margin:"40px 0"}}),(0,r.jsx)("h2",{style:{fontSize:"32px",marginTop:"50px",marginBottom:"20px",fontWeight:"700",color:t.textColor,letterSpacing:"-0.5px"},children:"Bash Script Breakdown"}),(0,r.jsxs)("p",{style:{marginBottom:"20px",fontSize:"22px"},children:["We'll break the script into 7 sections. You can follow along"," ",(0,r.jsx)("a",{href:"https://github.com/pcaversaccio/white-hat-frontrunning/blob/main/go.sh",target:"_blank",rel:"noopener noreferrer",style:{color:t.linkColor,textDecoration:"none",fontWeight:"600"},children:"here"}),"."]}),(0,r.jsx)("h3",{style:{fontSize:"24px",marginTop:"40px",marginBottom:"16px",fontWeight:"700",color:t.textColor},children:"1. Variable Checks"}),(0,r.jsx)("p",{style:{marginBottom:"16px",fontSize:"22px"},children:"Ensures required environment variables (like private keys, RPC URLs) are set."}),(0,r.jsx)("pre",{style:{backgroundColor:t.codeBg,padding:"20px",borderRadius:"8px",overflow:"auto",fontSize:"14px",marginBottom:"20px",border:"1px solid ".concat(t.borderColor),lineHeight:"1.6"},children:(0,r.jsx)("code",{style:{color:t.codeText},children:'check_var() {\n  if [[ -z "${!1}" ]]; then\n    echo "Error: $1 is not set in the .env file"\n    exit 1\n  else\n    echo "$1 is set"\n  fi\n}'})}),(0,r.jsx)("p",{style:{marginBottom:"16px",fontSize:"22px"},children:"Variables checked:"}),(0,r.jsx)("pre",{style:{backgroundColor:t.codeBg,padding:"20px",borderRadius:"8px",overflow:"auto",fontSize:"14px",marginBottom:"20px",border:"1px solid ".concat(t.borderColor),lineHeight:"1.6"},children:(0,r.jsx)("code",{style:{color:t.codeText},children:"vars=(\n  PROVIDER_URL\n  RELAY_URL\n  VICTIM_PK\n  GAS_PK\n  FLASHBOTS_SIGNATURE_PK\n  TOKEN_CONTRACT\n)"})}),(0,r.jsxs)("p",{style:{marginBottom:"20px",fontSize:"22px"},children:["This prevents runtime errors if something is missing in ",(0,r.jsx)("code",{style:{backgroundColor:t.cardBg,padding:"2px 6px",borderRadius:"4px",fontSize:"15px"},children:".env"}),"."]}),(0,r.jsx)("h3",{style:{fontSize:"24px",marginTop:"40px",marginBottom:"16px",fontWeight:"700",color:t.textColor},children:"2. Wallet Derivation"}),(0,r.jsxs)("p",{style:{marginBottom:"16px",fontSize:"22px"},children:["Derives wallet addresses from private keys using Foundry's ",(0,r.jsx)("code",{style:{backgroundColor:t.cardBg,padding:"2px 6px",borderRadius:"4px",fontSize:"15px"},children:"cast"}),"."]}),(0,r.jsx)("pre",{style:{backgroundColor:t.codeBg,padding:"20px",borderRadius:"8px",overflow:"auto",fontSize:"14px",marginBottom:"20px",border:"1px solid ".concat(t.borderColor),lineHeight:"1.6"},children:(0,r.jsx)("code",{style:{color:t.codeText},children:'derive_wallet() {\n  local pk="$1"\n  cast wallet address --private-key "$pk"\n}'})}),(0,r.jsx)("h3",{style:{fontSize:"24px",marginTop:"40px",marginBottom:"16px",fontWeight:"700",color:t.textColor},children:"3. Flashbots Signature Creation"}),(0,r.jsx)("p",{style:{marginBottom:"16px",fontSize:"22px"},children:"Creates a signature so Flashbots can authenticate the bundle."}),(0,r.jsx)("pre",{style:{backgroundColor:t.codeBg,padding:"20px",borderRadius:"8px",overflow:"auto",fontSize:"14px",marginBottom:"20px",border:"1px solid ".concat(t.borderColor),lineHeight:"1.6"},children:(0,r.jsx)("code",{style:{color:t.codeText},children:'create_flashbots_signature() {\n  local payload="$1"\n  local private_key="$2"\n  local payload_keccak=$(cast keccak "$payload")\n  local payload_hashed=$(cast hash-message "$payload_keccak")\n  local signature=$(cast wallet sign "$payload_hashed" \\\n    --private-key "$private_key" --no-hash | tr -d \'\\n\')\n  echo "$signature"\n}'})}),(0,r.jsx)("h3",{style:{fontSize:"24px",marginTop:"40px",marginBottom:"16px",fontWeight:"700",color:t.textColor},children:"4. Transaction Building"}),(0,r.jsxs)("p",{style:{marginBottom:"16px",fontSize:"22px"},children:["Instead of ",(0,r.jsx)("code",{style:{backgroundColor:t.cardBg,padding:"2px 6px",borderRadius:"4px",fontSize:"15px"},children:"cast send"}),", we use ",(0,r.jsx)("code",{style:{backgroundColor:t.cardBg,padding:"2px 6px",borderRadius:"4px",fontSize:"15px"},children:"cast mktx"})," to manually craft transactions with nonce and gas fee control."]}),(0,r.jsx)("pre",{style:{backgroundColor:t.codeBg,padding:"20px",borderRadius:"8px",overflow:"auto",fontSize:"14px",marginBottom:"20px",border:"1px solid ".concat(t.borderColor),lineHeight:"1.6"},children:(0,r.jsx)("code",{style:{color:t.codeText},children:'cast mktx --private-key "$from_pk"\n		--rpc-url "$PROVIDER_URL"\n		"$to_address" $([[ -n "$data" ]] && echo -n "$data")\n		--value "$value"\n		--nonce "$nonce"\n		--gas-price "$gas_price"\n		--priority-gas-price "$priority_gas_price"\n		--gas-limit "$gas_limit"\n}'})}),(0,r.jsxs)("div",{style:{marginBottom:"20px",padding:"20px",backgroundColor:t.cardBg,borderLeft:"4px solid ".concat(t.categoryBorder),borderRadius:"4px"},children:[(0,r.jsx)("p",{style:{margin:0,fontWeight:"600",color:t.textColor,marginBottom:"12px"},children:"Nonce logic:"}),(0,r.jsxs)("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"16px"},children:[(0,r.jsx)("li",{style:{marginBottom:"8px"},children:"If confirmed nonce = 6, the next valid nonce = 7."}),(0,r.jsx)("li",{style:{marginBottom:"8px"},children:"Hacker submits tx with nonce 7."}),(0,r.jsx)("li",{style:{marginBottom:"8px"},children:"You also submit tx with nonce 7, but with higher priority fee."}),(0,r.jsx)("li",{children:"Validator includes yours, hacker's is dropped."})]})]}),(0,r.jsx)("h3",{style:{fontSize:"24px",marginTop:"40px",marginBottom:"16px",fontWeight:"700",color:t.textColor},children:"5. Transaction Bundle Creation"}),(0,r.jsx)("p",{style:{marginBottom:"16px",fontSize:"22px"},children:"Bundles multiple transactions into JSON for Flashbots."}),(0,r.jsx)("pre",{style:{backgroundColor:t.codeBg,padding:"20px",borderRadius:"8px",overflow:"auto",fontSize:"14px",marginBottom:"20px",border:"1px solid ".concat(t.borderColor),lineHeight:"1.6"},children:(0,r.jsx)("code",{style:{color:t.codeText},children:'BUNDLE_JSON="{"jsonrpc":"2.0","id":1,"method":"eth_sendBundle","params":[{"txs":[$txs_string],"blockNumber":"$(cast to-hex "$BLOCK_NUMBER")","minTimestamp":0}]}"'})}),(0,r.jsx)("p",{style:{marginBottom:"16px",fontSize:"22px"},children:"Looks like this in json format."}),(0,r.jsx)("pre",{style:{backgroundColor:t.codeBg,padding:"20px",borderRadius:"8px",overflow:"auto",fontSize:"14px",marginBottom:"20px",border:"1px solid ".concat(t.borderColor),lineHeight:"1.6"},children:(0,r.jsx)("code",{style:{color:t.codeText},children:'"jsonrpc": "2.0",\n  "id": 1,\n  "method": "eth_sendBundle",\n  "params": [\n    {\n      "txs": ["Tx1", "Tx2"],\n      "blockNumber": "BlockNumberHex",\n      "minTimestamp": 0\n    }\n  ]\n}'})}),(0,r.jsx)("p",{style:{marginBottom:"20px",fontSize:"22px"},children:"Flashbots expects this exact format. Bundling ensures atomic execution, all rescue txs succeed together."}),(0,r.jsx)("h3",{style:{fontSize:"24px",marginTop:"40px",marginBottom:"16px",fontWeight:"700",color:t.textColor},children:"6. Sending the Bundle"}),(0,r.jsx)("p",{style:{marginBottom:"16px",fontSize:"22px"},children:"Sends the bundle to Flashbots relay using curl with proper headers."}),(0,r.jsx)("pre",{style:{backgroundColor:t.codeBg,padding:"20px",borderRadius:"8px",overflow:"auto",fontSize:"14px",marginBottom:"20px",border:"1px solid ".concat(t.borderColor),lineHeight:"1.6"},children:(0,r.jsx)("code",{style:{color:t.codeText},children:'curl -X POST "{headers[@]}" \n		-d "$(echo -n "$bundle_json")" "$RELAY_URL"\n'})}),(0,r.jsx)("h3",{style:{fontSize:"24px",marginTop:"40px",marginBottom:"16px",fontWeight:"700",color:t.textColor},children:"7. User Customization"}),(0,r.jsx)("p",{style:{marginBottom:"16px",fontSize:"22px"},children:"Here's where you tweak gas fees and limits."}),(0,r.jsx)("pre",{style:{backgroundColor:t.codeBg,padding:"20px",borderRadius:"8px",overflow:"auto",fontSize:"14px",marginBottom:"20px",border:"1px solid ".concat(t.borderColor),lineHeight:"1.6"},children:(0,r.jsx)("code",{style:{color:t.codeText},children:'GAS_PRICE=$(cast gas-price --rpc-url "$PROVIDER_URL")\nGAS_PRICE=$(((GAS_PRICE * 125) / 100))   # bump by 25%'})}),(0,r.jsx)("hr",{style:{border:"none",borderTop:"1px solid ".concat(t.borderColor),margin:"40px 0"}}),(0,r.jsx)("h2",{style:{fontSize:"32px",marginTop:"50px",marginBottom:"20px",fontWeight:"700",color:t.textColor,letterSpacing:"-0.5px"},children:"How Can We Improve This?"}),(0,r.jsx)("p",{style:{marginBottom:"20px",fontSize:"22px"},children:"Two main ideas:"}),(0,r.jsxs)("ol",{style:{marginLeft:"20px",marginBottom:"20px",fontSize:"22px"},children:[(0,r.jsxs)("li",{style:{marginBottom:"12px"},children:[(0,r.jsx)("strong",{style:{color:t.textColor},children:"Multi-relay submission:"})," so that if one relay fails, others may succeed."]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{style:{color:t.textColor},children:"Secure key storage:"})," .env is convenient but unsafe. For production or rescue scripts, use Foundry’s keystore system (cast wallet import) so private keys stay encrypted and invisible. This makes your whitehat frontrunning bot far more secure."]})]}),(0,r.jsx)("hr",{style:{border:"none",borderTop:"1px solid ".concat(t.borderColor),margin:"40px 0"}}),(0,r.jsx)("h2",{style:{fontSize:"32px",marginTop:"50px",marginBottom:"20px",fontWeight:"700",color:t.textColor,letterSpacing:"-0.5px"},children:"Key Takeaway"}),(0,r.jsxs)("p",{style:{marginBottom:"20px",fontSize:"22px"},children:["Frontrunning is often seen as malicious, but Pcaversaccio's script shows how it can be repurposed as a ",(0,r.jsx)("strong",{style:{color:t.textColor},children:"whitehat defense mechanism"}),". By racing hackers with higher-fee replacement transactions, owners can protect compromised wallets."]}),(0,r.jsx)("p",{style:{marginBottom:"20px",fontSize:"18px",fontStyle:"italic",fontFamily:"Georgia, serif"},children:"Sometimes the best defense in blockchain is to play the attacker's game, but smarter."})]}),(0,r.jsx)("footer",{style:{marginTop:"40px",paddingTop:"30px",paddingBottom:"40px",borderTop:"2px solid ".concat(t.borderColor),textAlign:"center",color:t.accentColor,fontSize:"13px"},children:(0,r.jsx)("a",{href:"/",style:{color:t.linkColor,textDecoration:"none",fontWeight:"600",display:"inline-flex",alignItems:"center",gap:"6px",transition:"gap 0.2s ease"},onMouseOver:e=>e.currentTarget.style.gap="10px",onMouseOut:e=>e.currentTarget.style.gap="6px",children:"← Back to all posts"})})]})]})}},1724:(e,o,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/posts/security_1",function(){return t(290)}])}},e=>{e.O(0,[636,593,792],()=>e(e.s=1724)),_N_E=e.O()}]);