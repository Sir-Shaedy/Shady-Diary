<!DOCTYPE html><html><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-b66ed8ba6f029a99.js" defer=""></script><script src="/_next/static/chunks/framework-292291387d6b2e39.js" defer=""></script><script src="/_next/static/chunks/main-029962fd5d7a53b3.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9ccadb934b519984.js" defer=""></script><script src="/_next/static/chunks/pages/posts/security_1-0b21332aaa88f99d.js" defer=""></script><script src="/_next/static/qYEY5EV6iRHcavaeTWyHJ/_buildManifest.js" defer=""></script><script src="/_next/static/qYEY5EV6iRHcavaeTWyHJ/_ssgManifest.js" defer=""></script></head><body><link rel="preload" as="image" href="/images/sandwich.png"/><div id="__next"><div style="min-height:100vh;background-color:#0a0a0a;color:#ffffff;transition:background-color 0.3s ease, color 0.3s ease"><div style="position:fixed;top:0;left:0;right:0;height:250px;background:linear-gradient(135deg, #3b82f615 0%, #8b5cf615 100%);opacity:0.5;pointer-events:none;z-index:0;transition:background 0.3s ease"></div><div style="max-width:800px;margin:0 auto;padding:0 20px;position:relative;z-index:1"><header style="padding-top:30px;margin-bottom:50px;display:flex;justify-content:space-between;align-items:center"><a href="/" style="color:#60a5fa;text-decoration:none;font-size:14px;font-weight:600;display:inline-flex;align-items:center;gap:6px;transition:gap 0.2s ease">← Back to all posts</a><button style="padding:10px 20px;background-color:#141414;color:#ffffff;border:2px solid #2a2a2a;border-radius:50px;cursor:pointer;font-size:14px;font-weight:600;transition:all 0.3s ease;box-shadow:0 4px 12px rgba(0,0,0,0.3)">☀️ Light</button></header><div style="margin-bottom:50px"><div style="margin-bottom:20px;display:flex;gap:12px;align-items:center"><span style="display:inline-block;padding:6px 14px;background-color:#1e3a5f;border-radius:20px;font-size:11px;font-weight:700;color:#60a5fa;text-transform:uppercase;letter-spacing:0.8px;border:1px solid #2563eb">Blockchain Security</span><span style="font-size:13px;color:#e7e2e2ff;font-weight:500">12 min read</span></div><h1 style="font-size:44px;font-weight:800;margin-bottom:16px;line-height:1.2;letter-spacing:-1px;color:#ffffff">Understanding Pcaversaccio&#x27;s Whitehat Frontrunning Script</h1><p style="font-size:14px;color:#e7e2e2ff;font-weight:500">Published on November 16, 2025</p></div><article style="font-size:17px;line-height:1.8;color:#e7e2e2ff;padding-bottom:60px"><h2 style="font-size:32px;margin-top:50px;margin-bottom:20px;font-weight:700;color:#ffffff;letter-spacing:-0.5px">Introduction: What is Frontrunning?</h2><p style="margin-bottom:20px;font-size:22px">Frontrunning is a common occurrence in blockchain, especially in DeFi trades where opportunistic actors exploit transaction timing to steal value. Put simply, frontrunning is the act of anticipating someone else&#x27;s transaction and submitting your own first, usually with a higher fee, since validators prioritize transactions that maximize their income.</p><p style="margin-bottom:20px;font-size:22px">While often malicious, frontrunning can also be used defensively. In cases of wallet compromise, the rightful owner can race the hacker by submitting a replacement transaction with the same nonce but a higher fee. Recently, I discovered Pcaversaccio&#x27;s whitehat frontrunning script, which turns this tactic into a powerful rescue tool. In this article, I&#x27;ll explore how it works.</p><hr style="border:none;border-top:1px solid #2a2a2a;margin:40px 0"/><h2 style="font-size:32px;margin-top:50px;margin-bottom:20px;font-weight:700;color:#ffffff;letter-spacing:-0.5px">How Exactly Does Frontrunning Happen?</h2><p style="margin-bottom:20px;font-size:22px">Consider this simple analogy:</p><p style="margin-bottom:20px;padding:20px;font-size:22px;background-color:#141414;border-left:4px solid #60a5fa;border-radius:4px">Imagine Alice, a Justin Bieber fan, wants to buy a concert ticket online. There&#x27;s only one ticket left. Bob sees Alice&#x27;s request and quickly submits his own purchase with faster processing. Bob gets the ticket first, leaving Alice out. Unfair, right?</p><p style="margin-bottom:20px;font-size:22px">Now replace <strong style="color:#ffffff">&quot;ticket&quot;</strong> with <strong style="color:#ffffff">&quot;transaction&quot;</strong> and <strong style="color:#ffffff">&quot;processing speed&quot;</strong> with <strong style="color:#ffffff">&quot;gas fee.&quot;</strong> This scenario happens a lot in DeFi, where trades affect token prices. For example, Mark submits a large buy order that will raise a token&#x27;s price. A frontrunner can jump ahead, buy at the lower price, then sell immediately after Mark&#x27;s transaction executes. This is called a <strong style="color:#ffffff">sandwich attack</strong>.</p><div style="margin:40px 0;padding:10px;width:500px;align-items:center;background-color:#141414;border-radius:12px;border:1px solid #2a2a2a;margin-left:70px"><img src="/images/sandwich.png" alt="Sandwich Attack Diagram" style="max-width:100%;height:auto;border-radius:10px;box-shadow:0 4px 20px rgba(0,0,0,0.4)"/></div><hr style="border:none;border-top:1px solid #2a2a2a;margin:40px 0"/><h2 style="font-size:32px;margin-top:50px;margin-bottom:20px;font-weight:700;color:#ffffff;letter-spacing:-0.5px">What the Whitehat Script Does</h2><p style="margin-bottom:20px;font-size:22px">Imagine logging into your wallet and realizing it&#x27;s been hacked. Normally, you&#x27;d try to quickly transfer funds out, but reflexes alone rarely beat automated bots.</p><p style="margin-bottom:20px;font-size:22px">Instead, Pcaversaccio&#x27;s script lets you craft a transaction with the <strong style="color:#ffffff">same nonce</strong> as the hacker&#x27;s, but with a <strong style="color:#ffffff">higher priority fee</strong>. Submitted via <strong style="color:#ffffff">Flashbots</strong>, your transaction stays private (hidden from the public mempool), giving you a higher chance of winning the race. In short: you frontrun the hacker to rescue your own funds.</p><hr style="border:none;border-top:1px solid #2a2a2a;margin:40px 0"/><h2 style="font-size:32px;margin-top:50px;margin-bottom:20px;font-weight:700;color:#ffffff;letter-spacing:-0.5px">Bash Script Breakdown</h2><p style="margin-bottom:20px;font-size:22px">We&#x27;ll break the script into 7 sections. You can follow along<!-- --> <a href="https://github.com/pcaversaccio/white-hat-frontrunning/blob/main/go.sh" target="_blank" rel="noopener noreferrer" style="color:#60a5fa;text-decoration:none;font-weight:600">here</a>.</p><h3 style="font-size:24px;margin-top:40px;margin-bottom:16px;font-weight:700;color:#ffffff">1. Variable Checks</h3><p style="margin-bottom:16px;font-size:22px">Ensures required environment variables (like private keys, RPC URLs) are set.</p><pre style="background-color:#1a1a1a;padding:20px;border-radius:8px;overflow:auto;font-size:14px;margin-bottom:20px;border:1px solid #2a2a2a;line-height:1.6"><code style="color:#e5e5e5">check_var() {
  if [[ -z &quot;${!1}&quot; ]]; then
    echo &quot;Error: $1 is not set in the .env file&quot;
    exit 1
  else
    echo &quot;$1 is set&quot;
  fi
}</code></pre><p style="margin-bottom:16px;font-size:22px">Variables checked:</p><pre style="background-color:#1a1a1a;padding:20px;border-radius:8px;overflow:auto;font-size:14px;margin-bottom:20px;border:1px solid #2a2a2a;line-height:1.6"><code style="color:#e5e5e5">vars=(
  PROVIDER_URL
  RELAY_URL
  VICTIM_PK
  GAS_PK
  FLASHBOTS_SIGNATURE_PK
  TOKEN_CONTRACT
)</code></pre><p style="margin-bottom:20px;font-size:22px">This prevents runtime errors if something is missing in <code style="background-color:#141414;padding:2px 6px;border-radius:4px;font-size:15px">.env</code>.</p><h3 style="font-size:24px;margin-top:40px;margin-bottom:16px;font-weight:700;color:#ffffff">2. Wallet Derivation</h3><p style="margin-bottom:16px;font-size:22px">Derives wallet addresses from private keys using Foundry&#x27;s <code style="background-color:#141414;padding:2px 6px;border-radius:4px;font-size:15px">cast</code>.</p><pre style="background-color:#1a1a1a;padding:20px;border-radius:8px;overflow:auto;font-size:14px;margin-bottom:20px;border:1px solid #2a2a2a;line-height:1.6"><code style="color:#e5e5e5">derive_wallet() {
  local pk=&quot;$1&quot;
  cast wallet address --private-key &quot;$pk&quot;
}</code></pre><h3 style="font-size:24px;margin-top:40px;margin-bottom:16px;font-weight:700;color:#ffffff">3. Flashbots Signature Creation</h3><p style="margin-bottom:16px;font-size:22px">Creates a signature so Flashbots can authenticate the bundle.</p><pre style="background-color:#1a1a1a;padding:20px;border-radius:8px;overflow:auto;font-size:14px;margin-bottom:20px;border:1px solid #2a2a2a;line-height:1.6"><code style="color:#e5e5e5">create_flashbots_signature() {
  local payload=&quot;$1&quot;
  local private_key=&quot;$2&quot;
  local payload_keccak=$(cast keccak &quot;$payload&quot;)
  local payload_hashed=$(cast hash-message &quot;$payload_keccak&quot;)
  local signature=$(cast wallet sign &quot;$payload_hashed&quot; \
    --private-key &quot;$private_key&quot; --no-hash | tr -d &#x27;\n&#x27;)
  echo &quot;$signature&quot;
}</code></pre><h3 style="font-size:24px;margin-top:40px;margin-bottom:16px;font-weight:700;color:#ffffff">4. Transaction Building</h3><p style="margin-bottom:16px;font-size:22px">Instead of <code style="background-color:#141414;padding:2px 6px;border-radius:4px;font-size:15px">cast send</code>, we use <code style="background-color:#141414;padding:2px 6px;border-radius:4px;font-size:15px">cast mktx</code> to manually craft transactions with nonce and gas fee control.</p><pre style="background-color:#1a1a1a;padding:20px;border-radius:8px;overflow:auto;font-size:14px;margin-bottom:20px;border:1px solid #2a2a2a;line-height:1.6"><code style="color:#e5e5e5">cast mktx --private-key &quot;$from_pk&quot;
		--rpc-url &quot;$PROVIDER_URL&quot;
		&quot;$to_address&quot; $([[ -n &quot;$data&quot; ]] &amp;&amp; echo -n &quot;$data&quot;)
		--value &quot;$value&quot;
		--nonce &quot;$nonce&quot;
		--gas-price &quot;$gas_price&quot;
		--priority-gas-price &quot;$priority_gas_price&quot;
		--gas-limit &quot;$gas_limit&quot;
}</code></pre><div style="margin-bottom:20px;padding:20px;background-color:#141414;border-left:4px solid #2563eb;border-radius:4px"><p style="margin:0;font-weight:600;color:#ffffff;margin-bottom:12px">Nonce logic:</p><ul style="margin:0;padding-left:20px;font-size:16px"><li style="margin-bottom:8px">If confirmed nonce = 6, the next valid nonce = 7.</li><li style="margin-bottom:8px">Hacker submits tx with nonce 7.</li><li style="margin-bottom:8px">You also submit tx with nonce 7, but with higher priority fee.</li><li>Validator includes yours, hacker&#x27;s is dropped.</li></ul></div><h3 style="font-size:24px;margin-top:40px;margin-bottom:16px;font-weight:700;color:#ffffff">5. Transaction Bundle Creation</h3><p style="margin-bottom:16px;font-size:22px">Bundles multiple transactions into JSON for Flashbots.</p><pre style="background-color:#1a1a1a;padding:20px;border-radius:8px;overflow:auto;font-size:14px;margin-bottom:20px;border:1px solid #2a2a2a;line-height:1.6"><code style="color:#e5e5e5">BUNDLE_JSON=&quot;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:1,&quot;method&quot;:&quot;eth_sendBundle&quot;,&quot;params&quot;:[{&quot;txs&quot;:[$txs_string],&quot;blockNumber&quot;:&quot;$(cast to-hex &quot;$BLOCK_NUMBER&quot;)&quot;,&quot;minTimestamp&quot;:0}]}&quot;</code></pre><p style="margin-bottom:16px;font-size:22px">Looks like this in json format.</p><pre style="background-color:#1a1a1a;padding:20px;border-radius:8px;overflow:auto;font-size:14px;margin-bottom:20px;border:1px solid #2a2a2a;line-height:1.6"><code style="color:#e5e5e5">&quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;id&quot;: 1,
  &quot;method&quot;: &quot;eth_sendBundle&quot;,
  &quot;params&quot;: [
    {
      &quot;txs&quot;: [&quot;Tx1&quot;, &quot;Tx2&quot;],
      &quot;blockNumber&quot;: &quot;BlockNumberHex&quot;,
      &quot;minTimestamp&quot;: 0
    }
  ]
}</code></pre><p style="margin-bottom:20px;font-size:22px">Flashbots expects this exact format. Bundling ensures atomic execution, all rescue txs succeed together.</p><h3 style="font-size:24px;margin-top:40px;margin-bottom:16px;font-weight:700;color:#ffffff">6. Sending the Bundle</h3><p style="margin-bottom:16px;font-size:22px">Sends the bundle to Flashbots relay using curl with proper headers.</p><pre style="background-color:#1a1a1a;padding:20px;border-radius:8px;overflow:auto;font-size:14px;margin-bottom:20px;border:1px solid #2a2a2a;line-height:1.6"><code style="color:#e5e5e5">curl -X POST &quot;{headers[@]}&quot; 
		-d &quot;$(echo -n &quot;$bundle_json&quot;)&quot; &quot;$RELAY_URL&quot;
</code></pre><h3 style="font-size:24px;margin-top:40px;margin-bottom:16px;font-weight:700;color:#ffffff">7. User Customization</h3><p style="margin-bottom:16px;font-size:22px">Here&#x27;s where you tweak gas fees and limits.</p><pre style="background-color:#1a1a1a;padding:20px;border-radius:8px;overflow:auto;font-size:14px;margin-bottom:20px;border:1px solid #2a2a2a;line-height:1.6"><code style="color:#e5e5e5">GAS_PRICE=$(cast gas-price --rpc-url &quot;$PROVIDER_URL&quot;)
GAS_PRICE=$(((GAS_PRICE * 125) / 100))   # bump by 25%</code></pre><hr style="border:none;border-top:1px solid #2a2a2a;margin:40px 0"/><h2 style="font-size:32px;margin-top:50px;margin-bottom:20px;font-weight:700;color:#ffffff;letter-spacing:-0.5px">How Can We Improve This?</h2><p style="margin-bottom:20px;font-size:22px">Two main ideas:</p><ol style="margin-left:20px;margin-bottom:20px;font-size:22px"><li style="margin-bottom:12px"><strong style="color:#ffffff">Multi-relay submission:</strong> so that if one relay fails, others may succeed.</li><li><strong style="color:#ffffff">Secure key storage:</strong> .env is convenient but unsafe. For production or rescue scripts, use Foundry’s keystore system (cast wallet import) so private keys stay encrypted and invisible. This makes your whitehat frontrunning bot far more secure.</li></ol><hr style="border:none;border-top:1px solid #2a2a2a;margin:40px 0"/><h2 style="font-size:32px;margin-top:50px;margin-bottom:20px;font-weight:700;color:#ffffff;letter-spacing:-0.5px">Key Takeaway</h2><p style="margin-bottom:20px;font-size:22px">Frontrunning is often seen as malicious, but Pcaversaccio&#x27;s script shows how it can be repurposed as a <strong style="color:#ffffff">whitehat defense mechanism</strong>. By racing hackers with higher-fee replacement transactions, owners can protect compromised wallets.</p><p style="margin-bottom:20px;font-size:18px;font-style:italic;font-family:Georgia, serif">Sometimes the best defense in blockchain is to play the attacker&#x27;s game, but smarter.</p></article><footer style="margin-top:40px;padding-top:30px;padding-bottom:40px;border-top:2px solid #2a2a2a;text-align:center;color:#e7e2e2ff;font-size:13px"><a href="/" style="color:#60a5fa;text-decoration:none;font-weight:600;display:inline-flex;align-items:center;gap:6px;transition:gap 0.2s ease">← Back to all posts</a></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/posts/security_1","query":{},"buildId":"qYEY5EV6iRHcavaeTWyHJ","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>